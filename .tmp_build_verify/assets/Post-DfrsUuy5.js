const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LexicalViewer-Dm1E6taJ.js","assets/react-core-BcR2_z_l.js","assets/lexical-CVusBMfS.js","assets/playground-overrides-BL6rcNro.js","assets/ContentEditable-BX3pcmlG.js","assets/ContentEditable-CWrSnP84.css","assets/PlaygroundNodes-ChCl_XRL.js","assets/index-ntR5v_s2.js","assets/mui-WkDK9qS1.js","assets/index-yv2-JTMp.css","assets/PlaygroundNodes-CkHyeEbx.css","assets/PollContext-CEXjjzNp.js","assets/PollContext-DlEuYIz7.css","assets/ImageLibraryDialog-BbbI0q6f.js","assets/index-CHWtszJ3.js","assets/index-BMIt2_cw.js","assets/createLucideIcon-M1JG7EBz.js","assets/index-DZ2Ey5_7.js","assets/chevron-right-CrdESc7p.js","assets/check-Cyy403AY.js","assets/accordion-DHuEXPng.js","assets/chevron-down-Mfh0mWaz.js","assets/button-C7iHbTqw.js","assets/index-Xj-Q384k.js","assets/index-CwaKb5FF.js","assets/dialog-CLWEkP9q.js","assets/input-BfSJiKKQ.js","assets/x-BpqL4Bns.js","assets/label-BwT1z_RF.js","assets/use-toast-DeMRPCeJ.js","assets/ImageLibraryDialog-B3TEaj-8.css","assets/index-DVZfbOhf.js","assets/trash-2-CSrjaLTp.js","assets/color-picker-Q1yTfexr.js","assets/color-picker-BOQRvWTA.css","assets/floating-ui.react-BugR93ss.js","assets/playground-overrides-K-LXsPQt.css","assets/PlaygroundEditorTheme-nA-I7k_h.js","assets/PlaygroundEditorTheme-BJ5jN8EW.css"])))=>i.map(i=>d[i]);
import{g as I,b as E,d as p,n as u,_ as P}from"./index-ntR5v_s2.js";import{h as S,r as t,j as e,L as U}from"./react-core-BcR2_z_l.js";import{L as k,W as A,D as L}from"./DiscordInviteCard-DqV3HUmW.js";import{P as _}from"./ProjectEmbedCard-C7Q0eiFB.js";import{C as T}from"./CommentsSection-DQcUB_pi.js";import{B as D}from"./badge-CX6RuieY.js";import{B}from"./button-C7iHbTqw.js";import{C as M,a as R}from"./card-VD61BBwz.js";import{e as z}from"./post-content-pZXP5BxF.js";import{u as V}from"./use-page-meta-ewLab265.js";import{a as $}from"./date-D79tpn1j.js";import{U as F}from"./user-4aZzULrg.js";import{C as O}from"./calendar-days-CGTk2DV6.js";import{C as W}from"./clock--Oqs7kqe.js";import"./mui-WkDK9qS1.js";import"./skeleton-DbpZ9Rjt.js";import"./sparkles-CtpH76yt.js";import"./createLucideIcon-M1JG7EBz.js";import"./index-Xj-Q384k.js";import"./project-utils-BfxKnQDe.js";import"./message-circle-qqsIJunn.js";import"./users-ok7q4J4c.js";import"./project-taxonomy-jSQkF-Xh.js";import"./use-dynamic-synopsis-clamp-DpjBDBPb.js";import"./avatar-CVZSwVae.js";import"./alert-dialog-ugflDUIb.js";import"./input-BfSJiKKQ.js";import"./index-CHWtszJ3.js";import"./separator-CDy1CE57.js";import"./textarea-BwWmg86h.js";import"./use-toast-DeMRPCeJ.js";import"./index-CwaKb5FF.js";import"./lexical-CVusBMfS.js";import"./PlaygroundNodes-ChCl_XRL.js";const q=t.lazy(()=>P(()=>import("./LexicalViewer-Dm1E6taJ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38]))),G=()=>e.jsx("div",{className:"min-h-[320px] w-full rounded-xl border border-border/60 bg-background/60 p-6 text-sm text-muted-foreground",children:"Carregando conteúdo..."}),Pe=()=>{const{slug:i}=S(),a=I(),[s,l]=t.useState(null),[h,x]=t.useState(!0),[j,n]=t.useState(!1),[c,d]=t.useState(null),f=t.useRef(new Set),{settings:g}=E();t.useEffect(()=>{let r=!0;return i&&(async()=>{try{x(!0);const o=await p(a,`/api/public/posts/${i}`);if(!o.ok){r&&(n(!0),l(null));return}const m=await o.json();r&&(l(m.post),n(!1))}catch{r&&(n(!0),l(null))}finally{r&&x(!1)}})(),()=>{r=!1}},[a,i]),t.useEffect(()=>{let r=!0;return(async()=>{try{const o=await p(a,"/api/public/me",{auth:!0});if(!o.ok){r&&d(null);return}const m=await o.json();r&&d(m?.user??null)}catch{r&&d(null)}})(),()=>{r=!1}},[a]),t.useEffect(()=>{s?.slug&&(f.current.has(s.slug)||(f.current.add(s.slug),p(a,`/api/public/posts/${s.slug}/view`,{method:"POST"})))},[a,s?.slug]);const b=t.useMemo(()=>u(s?.coverImageUrl)||u(g.site.defaultShareImage),[s?.coverImageUrl,g.site.defaultShareImage]);V({title:s?.seoTitle||s?.title||"Postagem",description:s?.seoDescription||s?.excerpt||"",image:b,type:"article"});const v=t.useMemo(()=>s?.publishedAt?$(s.publishedAt):"",[s?.publishedAt]),w=t.useMemo(()=>s?z(s.content||""):"",[s]),N=t.useMemo(()=>u(s?.coverImageUrl),[s?.coverImageUrl]),y=t.useMemo(()=>{const r=Array.isArray(c?.permissions)?c.permissions:[];return r.includes("*")||r.includes("posts")},[c]);return e.jsx("div",{className:"min-h-screen bg-background",children:e.jsx("main",{className:"px-6 pb-20 pt-14 md:px-12",children:e.jsx("div",{className:"mx-auto flex max-w-6xl flex-col gap-10",children:h?e.jsx("div",{className:"rounded-2xl border border-border/60 bg-card/60 px-6 py-10 text-sm text-muted-foreground",children:"Carregando postagem..."}):j||!s?e.jsx("div",{className:"rounded-2xl border border-dashed border-border/60 bg-card/60 px-6 py-10 text-sm text-muted-foreground",children:"Postagem não encontrada."}):e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground md:text-4xl",children:s.title}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4 text-primary/70","aria-hidden":"true"}),s.author||"Autor"]}),e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4 text-primary/70","aria-hidden":"true"}),v]}),e.jsxs("span",{className:"inline-flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4 text-primary/70","aria-hidden":"true"}),w]})]}),e.jsxs("div",{className:"flex flex-wrap justify-end gap-2",children:[e.jsx(D,{variant:"outline",className:"text-xs uppercase tracking-wide",children:"Postagem"}),y?e.jsx(B,{asChild:!0,size:"sm",variant:"outline",className:"h-7 px-2.5 text-[10px] uppercase",children:e.jsx(U,{to:`/dashboard/posts?edit=${encodeURIComponent(s.id)}`,children:"Editar postagem"})}):null]})]})]}),e.jsx("div",{className:"relative aspect-3/2 overflow-hidden rounded-2xl border border-border bg-card shadow-xs",children:e.jsx("img",{src:N||"/placeholder.svg",alt:s.coverAlt||`Capa do post: ${s.title}`,className:"absolute inset-0 block h-full w-full object-cover object-center",loading:"lazy"})})]}),e.jsxs("section",{className:"grid gap-8 lg:grid-cols-[minmax(0,2fr)_minmax(0,1fr)]",children:[e.jsxs("article",{className:"min-w-0 space-y-8",children:[e.jsx(M,{className:"border-border bg-card shadow-xs",children:e.jsx(R,{className:"min-w-0 space-y-7 p-6 text-sm leading-relaxed text-muted-foreground",children:e.jsx(t.Suspense,{fallback:e.jsx(G,{}),children:e.jsx(q,{value:s.content||"",className:"post-content reader-content min-w-0 w-full space-y-4 text-muted-foreground",pollTarget:s?.slug?{type:"post",slug:s.slug}:void 0})})})}),s.projectId?e.jsx(_,{projectId:s.projectId}):null,e.jsx(T,{targetType:"post",targetId:s.slug})]}),e.jsxs("aside",{className:"min-w-0 space-y-6",children:[e.jsx(k,{}),e.jsx(A,{}),e.jsx(L,{})]})]})]})})})})};export{Pe as default};
