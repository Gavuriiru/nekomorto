import{r,j as e,L as N}from"./react-core-BcR2_z_l.js";import{B as i}from"./badge-CX6RuieY.js";import{C as T,a as C}from"./card-VD61BBwz.js";import{g as E,d as h}from"./index-ntR5v_s2.js";import{b as k,s as L,t as y}from"./project-taxonomy-jSQkF-Xh.js";import{u as R}from"./use-dynamic-synopsis-clamp-DpjBDBPb.js";const A=8,B=46,_=65,H=`calc(${A}rem * ${_} / ${B})`,W=({projectId:t})=>{const n=E(),[s,l]=r.useState(null),[g,b]=r.useState(!1),[u,f]=r.useState({}),c=r.useMemo(()=>k(u),[u]),d=s?.id??t??"project-embed",{rootRef:j,lineByKey:v}=R({enabled:!!t,keys:[d],maxLines:5}),w=r.useMemo(()=>{const a=Array.isArray(s?.tags)?s.tags:[];return L(a,m=>y(m,c))},[s?.tags,c]),x=(()=>{const a=v[d]??0;return a<=0?2:Math.min(a,5)})();return r.useEffect(()=>{if(!t)return;let a=!0;return(async()=>{try{const o=await h(n,`/api/public/projects/${t}`);if(!o.ok){a&&l(null);return}const p=await o.json();a&&l(p.project||null)}catch{a&&l(null)}finally{a&&b(!0)}})(),()=>{a=!1}},[n,t]),r.useEffect(()=>{let a=!0;return(async()=>{try{const o=await h(n,"/api/public/tag-translations",{cache:"no-store"});if(!o.ok)return;const p=await o.json();a&&f(p.tags||{})}catch{a&&f({})}})(),()=>{a=!1}},[n]),!t||!s&&g?null:e.jsx(N,{to:`/projeto/${s?.id??t}`,className:"block focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-primary rounded-2xl",children:e.jsx(T,{className:"border-border bg-card shadow-xs transition-all duration-300 hover:-translate-y-1 hover:border-primary/40 hover:bg-card/90 hover:shadow-lg",children:e.jsx(C,{className:"space-y-4 p-4",children:e.jsxs("div",{ref:j,className:"group flex items-stretch gap-4",style:{height:H},children:[e.jsx("div",{className:"h-full w-32 shrink-0 self-start overflow-hidden rounded-xl",children:e.jsx("img",{src:s?.cover||"/placeholder.svg",alt:s?.title||"Projeto",className:"h-full w-full object-cover transition-transform duration-300 group-hover:scale-105"})}),e.jsxs("div",{"data-synopsis-role":"column","data-synopsis-key":d,className:"flex min-h-0 min-w-0 flex-1 self-stretch flex-col overflow-hidden",children:[e.jsxs("div",{"data-synopsis-role":"title",className:"space-y-1",children:[e.jsx("p",{className:"text-[10px] uppercase tracking-[0.2em] text-primary/80",children:s?.type||""}),e.jsx("span",{className:"line-clamp-2 text-lg font-semibold text-foreground transition group-hover:text-primary",children:s?.title||"Projeto"})]}),e.jsx("p",{"data-synopsis-role":"synopsis","data-synopsis-lines":x,className:"text-sm text-muted-foreground break-normal [overflow-wrap:normal] [word-break:normal]",style:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:x,overflow:"hidden"},children:s?.synopsis||""}),e.jsxs("div",{"data-synopsis-role":"badges",className:"mt-auto space-y-2",children:[e.jsxs("div",{"data-testid":"project-embed-primary-badges",className:"flex flex-nowrap items-center gap-2 overflow-hidden text-xs sm:flex-wrap",children:[s?.status?e.jsx(i,{"data-testid":"project-embed-status-badge",variant:"outline",className:"max-w-[8.5rem] truncate",children:s.status}):null,s?.studio?e.jsx(i,{"data-testid":"project-embed-studio-badge",variant:"outline",className:"max-w-[8.5rem] truncate",children:s.studio}):null,s?.episodes?e.jsx(i,{"data-testid":"project-embed-episodes-badge",variant:"outline",className:"hidden sm:inline-flex",children:s.episodes}):null]}),s?.tags?.length?e.jsx("div",{"data-testid":"project-embed-tags",className:"hidden flex-wrap gap-1.5 sm:flex",children:w.slice(0,4).map(a=>e.jsx(i,{variant:"secondary",className:"text-[9px] uppercase",children:y(a,c)},a))}):null]})]})]})})})})};export{W as P};
