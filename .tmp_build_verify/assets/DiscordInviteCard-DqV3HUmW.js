import{r as p,j as e,L as M}from"./react-core-BcR2_z_l.js";import{C as w,b as C,c as k,a as S}from"./card-VD61BBwz.js";import{B as y}from"./badge-CX6RuieY.js";import{S as h}from"./skeleton-DbpZ9Rjt.js";import{u as R,c as L,b as Q}from"./index-ntR5v_s2.js";import{f as W}from"./date-D79tpn1j.js";import{S as X}from"./sparkles-CtpH76yt.js";import{C as _}from"./clock--Oqs7kqe.js";import{c as F}from"./index-Xj-Q384k.js";import{b as J,a as K}from"./project-utils-BfxKnQDe.js";import{B as Y}from"./button-C7iHbTqw.js";import{M as Z}from"./message-circle-qqsIJunn.js";import{U as ee}from"./users-ok7q4J4c.js";const Ce=()=>{const{data:r,isLoading:s}=R(),i=r?.updates||[],d=s&&!r,n=p.useMemo(()=>{const a={};return(r?.projects||[]).forEach(t=>{t?.id&&(a[String(t.id)]=String(t.type||""))}),a},[r?.projects]);return e.jsxs(w,{className:"bg-card border-border overflow-hidden reveal transition-all duration-300 hover:-translate-y-1 hover:border-primary/40 hover:bg-card/90 hover:shadow-lg","data-reveal":!0,children:[e.jsxs(C,{className:"px-4 pb-3 pt-4",children:[e.jsxs(k,{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[e.jsx(X,{className:"w-4 h-4 text-primary"}),"Atualizações Recentes"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Novos links ou ajustes em episódios/capítulos publicados."})]}),e.jsx(S,{className:"space-y-3 px-4 pb-4 pt-0",children:d?e.jsx("div",{className:"soft-divider",children:Array.from({length:3}).map((a,t)=>e.jsxs("div",{className:"flex items-start gap-4 rounded-xl bg-background/40 p-4",children:[e.jsx(h,{className:"h-20 w-16 rounded-lg"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(h,{className:"h-3 w-24"}),e.jsx(h,{className:"h-4 w-3/4"}),e.jsx(h,{className:"h-3 w-2/3"})]})]},`update-skeleton-${t}`))}):i.length===0?e.jsx("div",{className:"rounded-xl border border-dashed border-border/60 bg-background/50 p-4 text-xs text-muted-foreground",children:"Nenhuma atualização recente cadastrada."}):e.jsx("div",{className:"soft-divider",children:[...i].sort((a,t)=>new Date(t.updatedAt||0).getTime()-new Date(a.updatedAt||0).getTime()).slice(0,5).map(a=>{const t=(n[a.projectId]||"").toLowerCase(),o=/cap/i.test(a.unit||"")||/cap/i.test(a.reason||""),l=t.includes("mang")||t.includes("webtoon")||t.includes("light")||t.includes("novel")||o,m=a.unit||(l?"Capítulo":"Episódio"),g=m==="Capítulo"?"Cap":"Ep",u=m==="Capítulo"?a.reason.replace(/epis[oó]dio/gi,"capítulo").replace(/cap[ií]tulo/gi,"Capítulo"):a.reason,c=u.charAt(0).toUpperCase()+u.slice(1),x=a.kind==="Lançamento"?"Lançamento":a.kind==="Ajuste"||a.kind==="Atualização"?"Ajuste":a.kind;return e.jsx(M,{to:`/projeto/${a.projectId}`,style:{"--card-h":"164px","--card-pad":"16px"},className:"group relative block h-(--card-h) rounded-2xl border border-border/60 bg-linear-to-br from-background/70 via-background/40 to-background/70 shadow-none transition-all duration-300 hover:-translate-y-1 hover:border-primary/40 hover:shadow-lg reveal","data-reveal":!0,children:e.jsxs("div",{className:"absolute inset-(--card-pad) flex items-start gap-4",children:[e.jsx("div",{className:"shrink-0 overflow-hidden rounded-xl bg-secondary/60 h-full aspect-46/65",children:e.jsx("img",{src:a.image||"/placeholder.svg",alt:a.projectTitle,className:"h-full w-full object-cover transition-transform duration-300 group-hover:scale-105"})}),e.jsxs("div",{className:"flex min-w-0 flex-1 flex-col gap-3 h-full",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(y,{variant:"secondary",className:"text-[10px]",children:[g," ",a.episodeNumber]}),e.jsx(y,{variant:"outline",className:`text-[10px] ${x==="Lançamento"?"border-primary/50 text-primary":x==="Ajuste"?"border-amber-500/50 text-amber-400":"border-border/60 text-muted-foreground"}`,children:x})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"text-sm font-semibold text-foreground transition-colors group-hover:text-primary line-clamp-2",children:a.projectTitle}),e.jsx("p",{className:"text-xs text-muted-foreground leading-relaxed line-clamp-2",children:c})]}),e.jsxs("span",{className:"mt-auto inline-flex items-center gap-1.5 text-[10px] text-muted-foreground",children:[e.jsx(_,{className:"h-3 w-3 text-primary/70","aria-hidden":"true"}),W(a.updatedAt.split("T")[0])]})]})]})},a.id)})})})]})};function re(r,s=[]){let i=[];function d(a,t){const o=p.createContext(t);o.displayName=a+"Context";const l=i.length;i=[...i,t];const m=u=>{const{scope:c,children:x,...b}=u,v=c?.[r]?.[l]||o,f=p.useMemo(()=>b,Object.values(b));return e.jsx(v.Provider,{value:f,children:x})};m.displayName=a+"Provider";function g(u,c){const x=c?.[r]?.[l]||o,b=p.useContext(x);if(b)return b;if(t!==void 0)return t;throw new Error(`\`${u}\` must be used within \`${a}\``)}return[m,g]}const n=()=>{const a=i.map(t=>p.createContext(t));return function(o){const l=o?.[r]||a;return p.useMemo(()=>({[`__scope${r}`]:{...o,[r]:l}}),[o,l])}};return n.scopeName=r,[d,te(n,...s)]}function te(...r){const s=r[0];if(r.length===1)return s;const i=()=>{const d=r.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(a){const t=d.reduce((o,{useScope:l,scopeName:m})=>{const u=l(a)[`__scope${m}`];return{...o,...u}},{});return p.useMemo(()=>({[`__scope${s.scopeName}`]:t}),[t])}};return i.scopeName=s.scopeName,i}var ae=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],D=ae.reduce((r,s)=>{const i=F(`Primitive.${s}`),d=p.forwardRef((n,a)=>{const{asChild:t,...o}=n,l=t?i:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(l,{...o,ref:a})});return d.displayName=`Primitive.${s}`,{...r,[s]:d}},{}),P="Progress",$=100,[se]=re(P),[oe,ne]=se(P),U=p.forwardRef((r,s)=>{const{__scopeProgress:i,value:d=null,max:n,getValueLabel:a=le,...t}=r;(n||n===0)&&!A(n)&&console.error(ie(`${n}`,"Progress"));const o=A(n)?n:$;d!==null&&!E(d,o)&&console.error(de(`${d}`,"Progress"));const l=E(d,o)?d:null,m=N(l)?a(l,o):void 0;return e.jsx(oe,{scope:i,value:l,max:o,children:e.jsx(D.div,{"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":N(l)?l:void 0,"aria-valuetext":m,role:"progressbar","data-state":z(l,o),"data-value":l??void 0,"data-max":o,...t,ref:s})})});U.displayName=P;var B="ProgressIndicator",V=p.forwardRef((r,s)=>{const{__scopeProgress:i,...d}=r,n=ne(B,i);return e.jsx(D.div,{"data-state":z(n.value,n.max),"data-value":n.value??void 0,"data-max":n.max,...d,ref:s})});V.displayName=B;function le(r,s){return`${Math.round(r/s*100)}%`}function z(r,s){return r==null?"indeterminate":r===s?"complete":"loading"}function N(r){return typeof r=="number"}function A(r){return N(r)&&!isNaN(r)&&r>0}function E(r,s){return N(r)&&!isNaN(r)&&r<=s&&r>=0}function ie(r,s){return`Invalid prop \`max\` of value \`${r}\` supplied to \`${s}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${$}\`.`}function de(r,s){return`Invalid prop \`value\` of value \`${r}\` supplied to \`${s}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${$} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var O=U,ce=V;const H=p.forwardRef(({className:r,indicatorClassName:s,value:i,...d},n)=>e.jsx(O,{ref:n,className:L("relative h-4 w-full overflow-hidden rounded-full bg-secondary",r),...d,children:e.jsx(ce,{className:L("h-full w-full flex-1 bg-primary transition-all",s),style:{transform:`translateX(-${100-(i||0)}%)`}})}));H.displayName=O.displayName;const T=[{id:"aguardando-raw",label:"Aguardando Raw",color:"bg-slate-500",badge:"bg-slate-500/20 text-slate-300 border-slate-500/40"},{id:"traducao",label:"Tradução",color:"bg-blue-500",badge:"bg-blue-500/20 text-blue-400 border-blue-500/30"},{id:"revisao",label:"Revisão",color:"bg-yellow-500",badge:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30"},{id:"timing",label:"Timing",color:"bg-pink-500",badge:"bg-pink-500/20 text-pink-400 border-pink-500/30"},{id:"typesetting",label:"Typesetting",color:"bg-indigo-500",badge:"bg-indigo-500/20 text-indigo-400 border-indigo-500/30"},{id:"quality-check",label:"Quality Check",color:"bg-orange-500",badge:"bg-orange-500/20 text-orange-400 border-orange-500/30"},{id:"encode",label:"Encode",color:"bg-purple-500",badge:"bg-purple-500/20 text-purple-400 border-purple-500/30"}],I=[{id:"aguardando-raw",label:"Aguardando Raw",color:"bg-slate-500",badge:"bg-slate-500/20 text-slate-300 border-slate-500/40"},{id:"traducao",label:"Tradução",color:"bg-blue-500",badge:"bg-blue-500/20 text-blue-400 border-blue-500/30"},{id:"limpeza",label:"Limpeza",color:"bg-emerald-500",badge:"bg-emerald-500/20 text-emerald-400 border-emerald-500/30"},{id:"redrawing",label:"Redrawing",color:"bg-cyan-500",badge:"bg-cyan-500/20 text-cyan-400 border-cyan-500/30"},{id:"revisao",label:"Revisão",color:"bg-yellow-500",badge:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30"},{id:"typesetting",label:"Typesetting",color:"bg-indigo-500",badge:"bg-indigo-500/20 text-indigo-400 border-indigo-500/30"},{id:"quality-check",label:"Quality Check",color:"bg-orange-500",badge:"bg-orange-500/20 text-orange-400 border-orange-500/30"}],ke=()=>{const{data:r,isLoading:s}=R(),i=r?.projects||[],d=s&&!r,a=p.useMemo(()=>{const t=[];return i.forEach(o=>{const l=o.type||"",m=J(l),g=K(l);if(m)return;const u=g?"manga":"anime";(o.episodeDownloads||[]).forEach(c=>{if((Array.isArray(c.sources)?c.sources.filter(j=>j.url):[]).length>0)return;const b=g?`Capítulo ${c.number}${c.volume?` • Vol. ${c.volume}`:""}`:`Episódio ${c.number}`,v=c.completedStages||[],f=u==="anime"?T:I,q=new Set(v),G=f.find(j=>!q.has(j.id))?.id||f[f.length-1]?.id||"aguardando-raw";t.push({id:`${o.id}-${c.number}`,title:o.title,entry:b,kind:u,currentStage:G,completedStages:v,projectId:o.id})})}),t},[i]);return e.jsxs(w,{className:"bg-card border-border reveal","data-reveal":!0,children:[e.jsx(C,{className:"px-4 pb-3 pt-4",children:e.jsxs(k,{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-primary/80"}),"Em Progresso"]})}),e.jsx(S,{className:"space-y-3 px-4 pb-4 pt-0",children:d?e.jsx("div",{className:"space-y-3",children:Array.from({length:2}).map((t,o)=>e.jsxs("div",{className:"rounded-md bg-secondary/40 p-3",children:[e.jsx(h,{className:"h-3 w-2/3"}),e.jsx(h,{className:"mt-2 h-2 w-1/2"}),e.jsx(h,{className:"mt-3 h-2 w-full"})]},`progress-skeleton-${o}`))}):a.length===0?e.jsx("div",{className:"rounded-xl border border-dashed border-border/60 bg-background/50 p-4 text-xs text-muted-foreground",children:"Nenhum episódio em progresso no momento."}):a.map(t=>{const o=t.kind==="anime"?T:I,l=new Set(t.completedStages),m=o.filter(c=>l.has(c.id)).length,g=Math.round(m/o.length*100),u=o.find(c=>c.id===t.currentStage)??o[0];return e.jsxs(M,{to:`/projeto/${t.projectId}`,className:"group/item block rounded-md border border-border/50 bg-secondary/50 p-3 transition-all duration-300 hover:-translate-y-1 hover:border-primary/40 hover:bg-secondary hover:shadow-lg",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground truncate transition-colors duration-300 group-hover/item:text-primary",children:t.title}),e.jsx("span",{className:"text-xs text-muted-foreground transition-colors duration-300 group-hover/item:text-foreground/80",children:t.entry})]}),e.jsx(y,{variant:"outline",className:`shrink-0 flex items-center gap-1 ${u.badge}`,children:u.label})]}),e.jsx("div",{className:"mt-3",children:e.jsx(H,{value:g,className:"h-2",indicatorClassName:u.color})})]},t.id)})})]})},Se=()=>{const{settings:r}=Q(),s=r.community.inviteCard,i=String(s.ctaUrl||r.community.discordUrl||"#").trim()||"#";return e.jsxs(w,{className:"bg-card border-border reveal","data-reveal":!0,children:[e.jsxs(C,{className:"px-4 pb-3 pt-4",children:[e.jsxs(k,{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-primary/80"}),s.title]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.subtitle})]}),e.jsxs(S,{className:"flex flex-col gap-3 px-4 pb-4 pt-0",children:[e.jsxs("div",{className:"group/panel space-y-2 rounded-xl border border-border/60 bg-background/40 p-3 transition-all duration-300 hover:-translate-y-1 hover:border-primary/40 hover:bg-background/70 hover:shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-foreground transition-colors duration-300 group-hover/panel:text-primary",children:[e.jsx(ee,{className:"h-4 w-4 text-primary/80 transition-colors duration-300 group-hover/panel:text-primary","aria-hidden":"true"}),s.panelTitle]}),e.jsx("p",{className:"text-xs text-muted-foreground leading-relaxed transition-colors duration-300 group-hover/panel:text-foreground/80",children:s.panelDescription})]}),e.jsx(Y,{asChild:!0,className:"w-full",children:e.jsx("a",{href:i,target:"_blank",rel:"noreferrer",children:s.ctaLabel})})]})]})};export{Se as D,Ce as L,ke as W};
