const n=["posts","projetos","comentarios","paginas","uploads","analytics","usuarios_basico","usuarios_acesso","configuracoes","audit_log","integracoes"],i=(()=>{const o="".trim().toLowerCase();return o?["1","true","yes","on"].includes(o):!1})(),p=o=>{const s=new Set;return(Array.isArray(o)?o:[]).forEach(e=>{const r=String(e||"").trim().toLowerCase();if(r){if(r==="*"){n.forEach(u=>s.add(u));return}if(r==="usuarios"){s.add("usuarios_basico"),s.add("usuarios_acesso");return}s.add(r)}}),s},c=()=>Object.fromEntries(n.map(o=>[o,!1])),h=o=>{const s=c();return!o||typeof o!="object"||n.forEach(e=>{s[e]=o[e]===!0}),s},g=o=>{const s=c();if(!o)return s;const e=String(o.id||""),r=Array.isArray(o.ownerIds)?o.ownerIds.map(t=>String(t)):[];if(r.includes(e))return n.forEach(t=>{s[t]=!0}),s;const u=p(o.permissions),a=t=>u.has(t);return s.posts=a("posts"),s.projetos=a("projetos"),s.comentarios=a("comentarios")||a("posts")||a("projetos"),s.paginas=a("paginas"),s.uploads=a("uploads")||a("posts")||a("projetos")||a("configuracoes"),s.analytics=a("analytics")||a("posts")||a("projetos")||a("comentarios"),s.usuarios_basico=a("usuarios_basico")||a("usuarios"),s.usuarios_acesso=a("usuarios_acesso")||a("usuarios"),s.configuracoes=a("configuracoes"),s.audit_log=r.includes(e),s.integracoes=a("integracoes")||a("configuracoes")||a("projetos"),s},w=o=>o?i?h(o.grants):g(o):c(),l=(o,s)=>!!(o&&o[s]===!0),f=o=>o?o.usuarios_basico||o.usuarios_acesso:!1,d={"/dashboard":null,"/dashboard/analytics":"analytics","/dashboard/posts":"posts","/dashboard/projetos":"projetos","/dashboard/comentarios":"comentarios","/dashboard/audit-log":"audit_log","/dashboard/usuarios":"users","/dashboard/paginas":"paginas","/dashboard/configuracoes":"configuracoes"},m=["/dashboard","/dashboard/analytics","/dashboard/posts","/dashboard/projetos","/dashboard/comentarios","/dashboard/audit-log","/dashboard/usuarios","/dashboard/paginas","/dashboard/configuracoes"],b=(o,s,{allowUsersForSelf:e=!1}={})=>{if(!i)return!0;const r=d[o];return r===void 0||r===null?!0:r==="users"?s?f(s)||e:!1:l(s,r)},y=o=>{const s=o.replace(/\/+$/,"")||"/",e=Object.keys(d).find(r=>!!(r===s||r!=="/dashboard"&&s.startsWith(`${r}/`)));return e?d[e]??null:null},j=(o,s,e)=>{if(!i)return!0;const r=y(o);return r===null?!0:r==="users"?!!f(s):l(s,r)},_=(o,s)=>i&&m.find(r=>b(r,o,{allowUsersForSelf:!1}))||"/dashboard",A=(o,s,e)=>o.map(r=>({...r,enabled:b(r.href,s,{allowUsersForSelf:!1})})).filter(r=>r.enabled);export{j as a,A as b,_ as g,i,w as r};
