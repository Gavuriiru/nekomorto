const a=/^[a-z0-9_-]+$/,o=r=>String(r||"").trim(),e=r=>{const t=r.toLowerCase();return t.startsWith("javascript:")||t.startsWith("vbscript:")||t.startsWith("data:")||t.startsWith("file:")||t.startsWith("blob:")},i=r=>{try{return new URL(r)}catch{return null}},u=r=>{const t=o(r);if(!t||e(t))return null;if(t.startsWith("/"))return t.startsWith("//")?null:t;const n=i(t);if(!n)return null;const s=String(n.protocol||"").toLowerCase();return s==="http:"||s==="https:"||s==="mailto:"||s==="tel:"?n.toString():null},l=r=>{const t=o(r);if(!t||e(t))return null;const n=t.toLowerCase();if(a.test(n))return n;if(t.startsWith("/uploads/"))return t;const s=i(t);return s&&String(s.protocol||"").toLowerCase()==="https:"?s.toString():null},c=r=>{const t=l(r);return t?t.startsWith("/uploads/")||t.startsWith("https://"):!1};export{l as a,c as i,u as s};
