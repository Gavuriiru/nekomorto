import{k as p,u as l,r as c,j as s}from"./react-core-BcR2_z_l.js";import{g as f,d as g}from"./index-ntR5v_s2.js";import{r as x,i as A,a as b,g as j}from"./access-control-C6qZ0ZhA.js";import{t as k}from"./use-toast-DeMRPCeJ.js";import"./mui-WkDK9qS1.js";const F=({children:u})=>{const t=p(),e=l(),[d,m]=c.useState(!0),n=f();return c.useEffect(()=>{let o=!0;return(async()=>{try{const a=await g(n,"/api/me",{auth:!0});if(!a.ok){const r=encodeURIComponent(`${e.pathname}${e.search||""}`);t(`/login?next=${r}`);return}const h=await a.json(),i=x(h||null);if(A&&e.pathname.startsWith("/dashboard")&&!b(e.pathname,i)){const r=j(i);k({title:"Acesso negado",description:"Você foi redirecionado para uma área permitida do painel."}),t(r,{replace:!0});return}o&&m(!1)}catch{const a=encodeURIComponent(`${e.pathname}${e.search||""}`);t(`/login?next=${a}`)}})(),()=>{o=!1}},[n,e.pathname,e.search,t]),d?s.jsx("div",{className:"flex min-h-screen items-center justify-center bg-background text-foreground",children:s.jsx("p",{className:"text-sm text-muted-foreground",children:"Verificando acesso..."})}):s.jsx(s.Fragment,{children:u})};export{F as default};
